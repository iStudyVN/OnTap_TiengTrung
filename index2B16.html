<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard Tiếng Trung</title>
    <style>
        /* CSS để nhúng font Simsun */
        @font-face {
            font-family: 'Simsun';
            src: url(https://fonts.gstatic.com/s/simsun/v18/K9-BZD0b9T8xcP0Q.woff2) format('woff2');
            unicode-range: U+4E00-9FFF; /* Phạm vi cho ký tự Hán */
        }

        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .scene {
            width: 100%;
            height: 300px;
            perspective: 600px;
            position: relative;
        }

        .card {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            cursor: pointer;
            transition: 
                transform 0.6s, 
                opacity 0.3s, 
                left 0.4s;
            transform-style: preserve-3d;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        /* --- HIỆU ỨNG TRƯỢT --- */
        .card.slide-next-out {
            transform: translateX(-100%) rotateY(0deg); 
            opacity: 0;
            pointer-events: none;
        }

        .card.slide-prev-out {
            transform: translateX(100%) rotateY(0deg); 
            opacity: 0;
            pointer-events: none;
        }

        .card__face {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; 
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 12px;
            background: #ffffff;
        }

        /* YÊU CẦU: Mặt trước chữ Hán, font Simsun, màu đen, ở giữa */
        .card__face--front {
            font-family: 'Simsun', sans-serif; 
            font-size: 80px;
            color: #000000; /* Chữ màu đen */
        }

        .card__face--back {
            transform: rotateY(180deg);
            padding: 20px;
            box-sizing: border-box;
            flex-direction: column;
            align-items: center; 
            justify-content: center;
            text-align: center; 
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
        }
        
        .back-content p {
            font-size: 1.3rem;
            margin: 8px 0;
            width: 100%;
            text-align: center; 
            font-weight: 500;
        }
        
        .back-content .pinyin { color: #e67e22; font-weight: bold; font-size: 1.6rem; } /* Màu cam */
        .back-content .hanviet { color: #8e44ad; } /* Màu tím */
        .back-content .nghia { color: #1f506b; font-style: italic; } /* Màu xanh đậm (thay vì #27ae60) */
        .back-content .vidu-han { color: #000000; font-family: 'Simsun', sans-serif; margin-top: 15px; font-size: 1.5rem; } /* Chữ Hán đen */
        .back-content .dichnghia { color: #000000; font-style: italic; font-size: 1rem; } /* Chữ đen */


        .navigation {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-button {
            padding: 10px 20px;
            border: none;
            background-color: #3498db;
            color: white;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0 5px;
        }

        .nav-button:hover {
            background-color: #2980b9;
        }
        
        #counter {
            font-size: 1.1rem;
            font-weight: bold;
            color: #7f8c8d;
            flex-grow: 1;
            text-align: center;
        }
        
        .jump-control {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
            gap: 10px;
            flex-wrap: wrap;
        }

        #jump-input {
            width: 60px;
            padding: 8px;
            border: 2px solid #3498db;
            border-radius: 8px;
            text-align: center;
            font-size: 1rem;
        }
        
        .jump-button {
            background-color: #e74c3c; 
        }
        
        .jump-button:hover {
            background-color: #c0392b;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>Flashcard Tiếng Trung</h1>
        <div class="scene">
            <div id="flashcard-container"></div>
        </div>
        <div class="navigation">
            <button class="nav-button" id="prev-btn">Trước</button>
            <span id="counter"></span>
            <button class="nav-button" id="next-btn">Sau</button>
        </div>
        
        <div class="jump-control">
            <input type="number" id="jump-input" min="1" max="30" placeholder="#">
            <button class="nav-button jump-button" id="jump-btn">Nhảy đến thẻ số</button>
        </div>
    </div>

    <script>
        // 30 từ vựng Hán ngữ giản thể được lấy từ shengci.txt
        const cardData = [
            { hanzi: '现在', pinyin: 'xiànzài', hanviet: 'hiện tại', nghia: 'Bây giờ', vidu: '我现在在学校。', dichnghia: 'Bây giờ tôi ở trường.' },
            { hanzi: '跟', pinyin: 'gēn', hanviet: 'căn', nghia: 'Với', vidu: '我跟朋友一起去超市。', dichnghia: 'Tôi đi siêu thị với bạn.' },
            { hanzi: '一起', pinyin: 'yìqǐ', hanviet: 'nhất khởi', nghia: 'Cùng nhau', vidu: '我们一起吃饭吧。', dichnghia: 'Chúng ta cùng ăn cơm nhé.' },
            { hanzi: '咱们', pinyin: 'zánmen', hanviet: 'ta môn', nghia: 'Chúng ta', vidu: '咱们去公园散步吧。', dichnghia: 'Chúng ta đi dạo công viên nhé.' },
            { hanzi: '走', pinyin: 'zǒu', hanviet: 'tẩu', nghia: 'Đi, bước đi', vidu: '他走得很快。', dichnghia: 'Anh ấy đi rất nhanh.' },
            { hanzi: '常常', pinyin: 'chángcháng', hanviet: 'thường thường', nghia: 'Thường xuyên', vidu: '我常常看书。', dichnghia: 'Tôi thường đọc sách.' },
            { hanzi: '有时候', pinyin: 'yǒu shíhou', hanviet: 'hữu thì hậu', nghia: 'Có lúc, đôi khi', vidu: '我有时候在家做饭。', dichnghia: 'Tôi đôi khi nấu ăn ở nhà.' },
            { hanzi: '借', pinyin: 'jiè', hanviet: 'tá', nghia: 'Mượn, cho mượn', vidu: '我借一本书。', dichnghia: 'Tôi mượn một cuốn sách.' },
            { hanzi: '上网', pinyin: 'shàng wǎng', hanviet: 'thượng võng', nghia: 'Lên mạng', vidu: '他每天上网两个小时。', dichnghia: 'Mỗi ngày anh ấy lên mạng 2 tiếng.' },
            { hanzi: '查', pinyin: 'chá', hanviet: 'tra', nghia: 'Tra, tìm kiếm', vidu: '我查一下词典。', dichnghia: 'Tôi tra từ điển một chút.' },
            { hanzi: '资料', pinyin: 'zīliào', hanviet: 'tư liệu', nghia: 'Tài liệu', vidu: '老师给我们很多学习资料。', dichnghia: 'Thầy cho chúng tôi nhiều tài liệu học tập.' },
            { hanzi: '总是', pinyin: 'zǒng shì', hanviet: 'tổng thị', nghia: 'Luôn luôn', vidu: '她总是很早起床。', dichnghia: 'Cô ấy luôn luôn dậy sớm.' },
            { hanzi: '安静', pinyin: 'ān jìng', hanviet: 'an tĩnh', nghia: 'Yên tĩnh', vidu: '图书馆很安静。', dichnghia: 'Thư viện rất yên tĩnh.' },
            { hanzi: '晚上', pinyin: 'wǎnshang', hanviet: 'vãn thượng', nghia: 'Buổi tối', vidu: '我晚上常常看电视。', dichnghia: 'Buổi tối tôi thường xem TV.' },
            { hanzi: '复习', pinyin: 'fùxí', hanviet: 'phục tập', nghia: 'Ôn tập', vidu: '我每天复习生词。', dichnghia: 'Mỗi ngày tôi ôn tập từ mới.' },
            { hanzi: '课文', pinyin: 'kèwén', hanviet: 'khóa văn', nghia: 'Bài khóa', vidu: '我们一起读课文。', dichnghia: 'Chúng ta cùng đọc bài khóa.' },
            { hanzi: '预习', pinyin: 'yùxí', hanviet: 'dự tập', nghia: 'Chuẩn bị bài', vidu: '明天的课文你预习了吗？', dichnghia: 'Bạn đã chuẩn bị bài khóa ngày mai chưa?' },
            { hanzi: '生词', pinyin: 'shēngcí', hanviet: 'sinh từ', nghia: 'Từ mới', vidu: '今天我们学十个生词。', dichnghia: 'Hôm nay chúng ta học 10 từ mới.' },
            { hanzi: '或者', pinyin: 'huòzhě', hanviet: 'hoặc giả', nghia: 'Hoặc, hoặc là', vidu: '我们去超市或者去公园。', dichnghia: 'Chúng ta đi siêu thị hoặc công viên.' },
            { hanzi: '练习', pinyin: 'liànxí', hanviet: 'luyện tập', nghia: 'Luyện tập', vidu: '他在练习说汉语。', dichnghia: 'Anh ấy đang luyện nói tiếng Trung.' },
            { hanzi: '收发', pinyin: 'shōufā', hanviet: 'thu phát', nghia: 'Nhận gửi', vidu: '我每天收发很多电子邮件。', dichnghia: 'Mỗi ngày tôi nhận gửi nhiều email.' },
            { hanzi: '聊天儿', pinyin: 'liáo tiānr', hanviet: 'liêu thiên nhi', nghia: 'Trò chuyện', vidu: '我喜欢跟朋友聊天儿。', dichnghia: 'Tôi thích trò chuyện với bạn bè.' },
            { hanzi: '伊妹儿', pinyin: 'yīmèir', hanviet: 'y muội nhi', nghia: 'Email', vidu: '给我发一个伊妹儿吧。', dichnghia: 'Gửi cho tôi một email nhé.' },
            { hanzi: '电影', pinyin: 'diànyǐng', hanviet: 'điện ảnh', nghia: 'Phim điện ảnh', vidu: '我周末看电影。', dichnghia: 'Cuối tuần tôi xem phim.' },
            { hanzi: '电视剧', pinyin: 'diànshìjù', hanviet: 'điện thị kịch', nghia: 'Phim truyền hình', vidu: '妈妈喜欢看电视剧。', dichnghia: 'Mẹ thích xem phim truyền hình.' },
            { hanzi: '休息', pinyin: 'xiūxi', hanviet: 'hưu tức', nghia: 'Nghỉ ngơi', vidu: '我想休息一下。', dichnghia: 'Tôi muốn nghỉ một chút.' },
            { hanzi: '宿舍', pinyin: 'sùshè', hanviet: 'túc xá', nghia: 'Kí túc xá', vidu: '我们住在学校宿舍。', dichnghia: 'Chúng tôi ở ký túc xá trường.' },
            { hanzi: '公园', pinyin: 'gōngyuán', hanviet: 'công viên', nghia: 'Công viên', vidu: '公园里有很多人。', dichnghia: 'Trong công viên có nhiều người.' },
            { hanzi: '超市', pinyin: 'chāoshì', hanviet: 'siêu thị', nghia: 'Siêu thị', vidu: '我去超市买东西。', dichnghia: 'Tôi đi siêu thị mua đồ.' },
            { hanzi: '东西', pinyin: 'dōngxī', hanviet: 'đông tây', nghia: 'Đồ đạc, thứ', vidu: '我买了很多东西。', dichnghia: 'Tôi đã mua nhiều đồ.' }
        ];

        const flashcardContainer = document.getElementById('flashcard-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const jumpBtn = document.getElementById('jump-btn');
        const jumpInput = document.getElementById('jump-input');
        const counter = document.getElementById('counter');

        let currentIndex = 0;
        let isTransitioning = false; 
        const totalCards = cardData.length;
        
        // Biến xử lý Vuốt (Swipe)
        let touchstartX = 0;
        let touchendX = 0;
        const SWIPE_THRESHOLD = 50; 
        
        jumpInput.max = totalCards;
        
        function renderCard(index) {
            const currentCard = cardData[index];
            const cardElement = document.createElement('div');
            cardElement.className = 'card';
            cardElement.id = 'flashcard-' + index;

            // Mặt trước: Chữ Hán, Simsun, Đen
            cardElement.innerHTML = `
                <div class="card__face card__face--front">${currentCard.hanzi}</div>
                <div class="card__face card__face--back">
                    <div class="back-content">
                        <p class="pinyin">${currentCard.pinyin}</p>
                        <p class="hanviet">${currentCard.hanviet}</p>
                        <p class="nghia">${currentCard.nghia}</p>
                        <p class="vidu-han">${currentCard.vidu}</p>
                        <p class="dichnghia">${currentCard.dichnghia}</p>
                    </div>
                </div>
            `;
            
            // Xử lý sự kiện lật thẻ
            cardElement.addEventListener('click', () => {
                if (!isTransitioning) {
                    cardElement.classList.toggle('is-flipped');
                }
            });

            // --- Logic Swipe ---
            cardElement.addEventListener('touchstart', e => {
                touchstartX = e.changedTouches[0].screenX;
            }, false);

            cardElement.addEventListener('touchend', e => {
                touchendX = e.changedTouches[0].screenX;
                handleGesture();
            }, false);
            
            return cardElement;
        }
        
        function updateDisplay() {
            counter.textContent = `${currentIndex + 1} / ${totalCards}`;
        }

        function changeCard(newIndex, direction) {
            if (isTransitioning || newIndex === currentIndex) {
                return;
            }

            if (newIndex < 0) {
                newIndex = totalCards - 1;
            } else if (newIndex >= totalCards) {
                newIndex = 0;
            }

            isTransitioning = true;
            const oldCard = document.getElementById('flashcard-' + currentIndex);
            const newCard = renderCard(newIndex);
            
            let slideDirection = direction;
            if (!slideDirection) {
                slideDirection = (newIndex > currentIndex || (currentIndex === totalCards - 1 && newIndex === 0)) ? 'next' : 'prev';
            }
            
            newCard.style.left = slideDirection === 'next' ? '100%' : '-100%';
            flashcardContainer.appendChild(newCard);
            
            if (oldCard) {
                oldCard.classList.add(slideDirection === 'next' ? 'slide-next-out' : 'slide-prev-out');
            }

            setTimeout(() => {
                newCard.style.left = '0';
            }, 50); 

            setTimeout(() => {
                if (oldCard) {
                    oldCard.remove();
                }
                currentIndex = newIndex;
                updateDisplay();
                isTransitioning = false;
            }, 400); 
        }
        
        function goToNextCard() {
            const newIndex = (currentIndex + 1) % totalCards;
            changeCard(newIndex, 'next');
        }

        function goToPrevCard() {
            const newIndex = (currentIndex - 1 + totalCards) % totalCards;
            changeCard(newIndex, 'prev');
        }
        
        function jumpToCard() {
            const inputValue = parseInt(jumpInput.value);
            
            if (isNaN(inputValue) || inputValue < 1 || inputValue > totalCards) {
                alert(`Lỗi: Vui lòng nhập số thẻ hợp lệ từ 1 đến ${totalCards}.`);
                jumpInput.value = "";
                return;
            }
            
            const newIndex = inputValue - 1;

            const direction = (newIndex > currentIndex) ? 'next' : 'prev';
            
            changeCard(newIndex, direction);

            jumpInput.value = "";
        }

        function handleGesture() {
            if (isTransitioning) return;
            const deltaX = touchendX - touchstartX;
            
            if (Math.abs(deltaX) > SWIPE_THRESHOLD) {
                if (deltaX < 0) {
                    goToNextCard();
                } else {
                    goToPrevCard();
                }
            }
        }

        prevBtn.addEventListener('click', goToPrevCard);
        nextBtn.addEventListener('click', goToNextCard);
        jumpBtn.addEventListener('click', jumpToCard);
        
        jumpInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                jumpToCard();
            }
        });

        // Initial load
        document.addEventListener('DOMContentLoaded', () => {
            flashcardContainer.appendChild(renderCard(currentIndex));
            updateDisplay();
        });

    </script>
</body>
</html>